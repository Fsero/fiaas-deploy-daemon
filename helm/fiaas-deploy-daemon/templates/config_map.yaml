apiVersion: v1
kind: ConfigMap
metadata:
  name: "{{ .Values.name }}"
  labels:
    app: "{{ .Values.name }}"
    chart: "{{ .Chart.Name }}-{{ .Chart.Version }}"
    release: "{{ .Release.Name }}"
    heritage: "{{ .Release.Service }}"
data:
  cluster_config.yaml: |-
    log-format: plain
    ingress-suffix:
    - "{{ .Values.ingress.domainName }}"
    {{with .Values.environment}}environment: {{.}}{{end}}
    {{with .Values.infrastructure}}infrastructure: {{.}}{{end}}
    {{with .Values.dataDogImage}}datadog-container-image: {{.}}{{end}}
    {{with .Values.preStopDelay}}pre-stop-delay: {{.}}{{end}}
    {{with .Values.TPR}}enable-tpr-support: {{.}}{{end}}
    {{with .Values.CRD}}enable-crd-support: {{.}}{{end}}
